<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<link rel="icon" href="/assets/images/logo.png">
<title>1X2S</title>
<link rel="stylesheet" href="/assets/css/core/global.css">
<link rel="stylesheet" href="/assets/css/core/fonts.css">
<link rel="stylesheet" href="/assets/css/pages/page-insights.css">
<link rel="stylesheet" href="/assets/css/components/index-webkit-mobile.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://unpkg.com/boxicons@2.1.4/dist/boxicons.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:wght@100" rel="stylesheet" />
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght@200" rel="stylesheet" />
</head>


<body>






<nav>
    <!-- Navbar / for pc devices -->
    <div id="navbar"></div>
    <script src="/assets/js/components/navbar.js"></script>
    <link rel="stylesheet" href="/assets/css/components/navbar.css">
</nav>
<mobilenav>
    <!-- Navbar / for mobile devices -->
    <div id="mobilenavbar"></div>
    <script src="/assets/js/components/mobile-navbar.js"></script>
    <link rel="stylesheet" href="/assets/css/components/mobile-navbar.css">
</mobilenav>  


<section id="section1">

  <h1>Weekly Insights</h1>
  <h3><span class="material-symbols-outlined">bolt</span>Powered by <b>LiteWS Sport</b> and Google <span>Gemini</span></h3>

</section>  




<section id="section2">


  <div class="section-content-body">

<div class="button-carousel-wrapper">
  <div class="button-carousel" id="button-carousel">
  </div>
</div>

<script>
function centerButton(btn) {
  const wrapper = document.querySelector('.button-carousel-wrapper');
  const btnRect = btn.getBoundingClientRect();
  const wrapperRect = wrapper.getBoundingClientRect();
  const btnCenter = btnRect.left + btnRect.width / 2;
  const wrapperCenter = wrapperRect.left + wrapperRect.width / 2;
  const scrollOffset = btnCenter - wrapperCenter;
  wrapper.scrollBy({
    left: scrollOffset,
    behavior: "smooth"
  });
  document.querySelectorAll('.card-button').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
}

function generateButtonCarousel(carouselData) {
  const buttonCarousel = document.getElementById('button-carousel');
  buttonCarousel.innerHTML = ''; // Clear existing buttons
  
  carouselData.forEach((data, index) => {
    const button = document.createElement('button');
    button.className = 'card-button' + (index === 0 ? ' active' : '');
    button.dataset.card = index;
    button.textContent = data.title;
    buttonCarousel.appendChild(button);
  });
  
  // Don't attach listeners here - will be done after cards are rendered
}

function attachButtonListeners() {
  const buttons = document.querySelectorAll('.card-button');
  
  buttons.forEach((btn) => {
    btn.addEventListener('click', function() {
      const cardIndex = parseInt(btn.dataset.card);
      const cards = document.querySelectorAll('.carousel-card');
      centerButton(btn);
      if (cards[cardIndex]) centerCard(cards[cardIndex]);
    });
  });
  
  // Center the first button and card on load
  if (buttons[0]) {
    centerButton(buttons[0]);
    const cards = document.querySelectorAll('.carousel-card');
    if (cards[0]) centerCard(cards[0]);
  }
}
</script>
<!-- ...existing code... -->




<div class="carousel-container" id="carousel-container">
  <div class="carousel" id="carousel">
    <!-- Carousel cards will be dynamically loaded here -->
  </div>
</div>

<script>
// ========== DYNAMIC CAROUSEL LOADER ==========

async function loadCarouselData() {
  try {
    const response = await fetch('/api/carousel/insights');
    
    if (!response.ok) {
      throw new Error(`API responded with status: ${response.status}`);
    }
    
    const result = await response.json();
    
    if (!result.success || !result.data) {
      throw new Error('Invalid API response format');
    }
    
    // Generate buttons from carousel data
    generateButtonCarousel(result.data);
    
    // Render carousel cards
    renderCarouselCards(result.data);
    
    // Attach button listeners now that cards exist
    attachButtonListeners();
    
    // Initialize interactions
    initializeCarouselInteractions();
    
  } catch (error) {
    console.error('Error loading carousel data:', error);
    // Fallback: show error message
    document.getElementById('carousel').innerHTML = `
      <div class="carousel-card" style="padding: 2rem; text-align: center;">
        <p>Unable to load insights data. Please try refreshing the page.</p>
      </div>
    `;
  }
}

function renderCarouselCards(data) {
  const carousel = document.getElementById('carousel');
  carousel.innerHTML = ''; // Clear placeholder
  
  data.forEach((cardData, index) => {
    const cardElement = document.createElement('div');
    cardElement.className = 'carousel-card' + (index === 0 ? ' centered' : '');
    cardElement.dataset.index = index;
    cardElement.dataset.cardId = cardData.id;
    
    // Format date if it exists
    const dateStr = cardData.date ? new Date(cardData.date).toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' }) : '';
    
    // Handle hierarchical structure with parents
    let parentsHTML = '';
    if (cardData.parents && cardData.parents.length > 0) {
      parentsHTML = cardData.parents.map((parent) => {
        const dropdownsHTML = parent.dropdowns && parent.dropdowns.length > 0
          ? parent.dropdowns.map((dropdown) => {
              const competitionInfo = dropdown.competition_name ? `
                <div style="display: flex; align-items: center; gap: 8px; flex-direction:row;">
                  ${dropdown.competition_icon ? `<img src="/assets/images/league-icons/${dropdown.competition_icon}" alt="${dropdown.competition_name}" style="height: 20px; width: auto; border-radius: 2px;" onerror="this.style.display='none'">` : '<span style="font-size: 1em;">üèÜ</span>'}
                  <span class="dropdown-context__info">${dropdown.competition_name}</span>
                </div>
              ` : '';
              
              const locationInfo = dropdown.location ? `<div class="dropdown-datetime__content"><a>${dropdown.location}</a></div>` : '';
              const timeInfo = dropdown.gmt_time ? `<div class="dropdown-datetime__content"><a>${dropdown.gmt_time} GMT</a></div>` : '';
              
              return `
                <div class="dropdown-section">
                  <button class="dropdown-toggle" onclick="toggleDropdown(event)">
                      ${dropdown.competition_icon ? `<img src="/assets/images/league-icons/${dropdown.competition_icon}" alt="${dropdown.competition_name}" style="height: 30px; width: auto; border-radius: 2px;" onerror="this.style.display='none'">` : '<span style="font-size: 1em;">üèÜ</span>'}
                    <span class="dropdown-header"><h1>${dropdown.header}</h1><h2>${dropdown.subheader || ''}</h2></span>
                    <span class="dropdown-subheader"><h1>${dropdown.subheader2 || ''}</h1></span>
                  </button>
                  <div class="dropdown-content" style="display: none;">
                    <div class="dropdown-info">
                      <div class="dropdown-context__info">
                        <div class="dropdown-context__league">
                          <span class="dropdown-context__info">${dropdown.competition_name}</span>
                        </div>
                        <div class="dropdown-datetime__display">${locationInfo}${timeInfo}</div>
                      </div>
                      <p class="dropdown-text">${dropdown.text || ''}</p>
                      <p class="dropdown-subtext">odds ${dropdown.subheader2 || ''}</p>
                      ${dropdown.link ? `<div style="margin-top: 8px;"><a href="${dropdown.link}" target="_blank" class="details-text__link">View Match Details <span class="material-symbols-outlined">open_in_new</span></a></div>` : ''}
                    </div>
                  </div>
                </div>
              `;
            }).join('')
          : '';
        
        return `
          <div class="parent-section" style="margin-bottom: 20px; padding: 15px;">
            ${parent.title ? `<h1>${parent.title}</h1>` : ''}
            ${parent.text ? `<h2>${parent.text}</h2>` : ''}
            <div class="parent-dropdowns">
              ${dropdownsHTML}
            </div>
          </div>
        `;
      }).join('');
    } else if (cardData.dropdowns && cardData.dropdowns.length > 0) {
      // Fallback: old flat structure
      parentsHTML = cardData.dropdowns.map((dropdown) => {
        const competitionInfo = dropdown.competition_name ? `
          <div style="display: flex; align-items: center; gap: 8px; flex-direction:row;">
            ${dropdown.competition_icon ? `<img src="/assets/images/league-icons/${dropdown.competition_icon}" alt="${dropdown.competition_name}" style="height: 20px; width: auto; border-radius: 2px;" onerror="this.style.display='none'">` : '<span style="font-size: 1em;">üèÜ</span>'}
            <span class="dropdown-context__info">${dropdown.competition_name}</span>
          </div>
        ` : '';
        
        const locationInfo = dropdown.location ? `<div class="dropdown-datetime__content"><a>${dropdown.location}</a></div>` : '';
        const timeInfo = dropdown.gmt_time ? `<div class="dropdown-datetime__content"><a>${dropdown.gmt_time} GMT</a></div>` : '';
        
        return `
          <div class="dropdown-section">
            <button class="dropdown-toggle" onclick="toggleDropdown(event)">
              <span class="dropdown-subheader">${dropdown.subheader || ''}</span><span class="dropdown-header">${dropdown.header}</span>
            </button>
            <div class="dropdown-content" style="display: none;">
              <div class="dropdown-info">
                <div class="dropdown-context__info">
                  <div class="dropdown-context__league">
                    <h1>${competitionInfo}</h1>
                  </div>
                  <div class="dropdown-datetime__display">${locationInfo}${timeInfo}</div>
                </div>
                <p class="dropdown-text">${dropdown.text || ''}</p>
                <p class="dropdown-subtext">${dropdown.subheader2 || ''}</p>
                ${dropdown.link ? `<div style="margin-top: 8px;"><a href="${dropdown.link}" target="_blank" class="details-text__link">View Match Details <span class="material-symbols-outlined">open_in_new</span></a></div>` : ''}
              </div>
            </div>
          </div>
        `;
      }).join('');
    }
    
    cardElement.innerHTML = `
      <div class="card-header-meta">
        <span class="card-date">${dateStr}</span>
        <span class="card-id">${cardData.id}</span>
      </div>
      
      <div class="card-title-section">
        <h1 class="card-title">${cardData.title || 'Untitled'}</h1>
        <p class="card-subtitle">${cardData.subtitle || ''}</p>
        <p class="card-description">${cardData.description || ''}</p>
      </div>
      
      <div class="card-dropdowns">
        ${parentsHTML}
      </div>
    `;
    
    carousel.appendChild(cardElement);
  });
}

function toggleDropdown(event) {
  const button = event.currentTarget;
  const content = button.nextElementSibling;
  const isOpen = content.style.display !== 'none';
  
  // Close all dropdowns
  document.querySelectorAll('.dropdown-content').forEach(el => el.style.display = 'none');
  document.querySelectorAll('.dropdown-arrow').forEach(el => el.style.transform = 'rotate(0deg)');
  
  // Open this dropdown if it wasn't open
  if (!isOpen) {
    content.style.display = 'block';
    button.querySelector('.dropdown-arrow').style.transform = 'rotate(180deg)';
  }
}

function centerCard(card) {
  const container = document.getElementById("carousel-container");
  const cardRect = card.getBoundingClientRect();
  const containerRect = container.getBoundingClientRect();

  const cardCenter = cardRect.left + cardRect.width / 2;
  const containerCenter = containerRect.left + containerRect.width / 2;

  const scrollOffset = cardCenter - containerCenter;

  container.scrollBy({
    left: scrollOffset,
    behavior: "smooth"
  });

  // Highlight the centered card
  document.querySelectorAll('.carousel-card').forEach(c => c.classList.remove('centered'));
  card.classList.add('centered');
}

function initializeCarouselInteractions() {
  // Attach button listeners (already done in attachButtonListeners called by generateButtonCarousel)
  // Setup dropdowns if the function exists
  if (typeof setupDropdowns === 'function') {
    setupDropdowns();
  }
}

// Load carousel data when DOM is ready
document.addEventListener("DOMContentLoaded", function() {
  loadCarouselData();
});
</script>

</section>


<section id="section3">

  <h3>Proprietary Datasets</h3>
  <p>Our insights are generated using a combination of proprietary datasets from LiteWS Sport and advanced AI models developed by Google Gemini. This unique blend of data sources allows us to provide accurate and timely sports insights.</p>
     <ul>
        <li>OPTA StatsPerform API</li>
        <li>SportsRadar API</li>
        <li>Google Gemini AI Models</li>
        <li>LiteWS Sport Proprietary Data</li>
        <li>Live Web News Feeds</li>
      </ul>

</section>



<section id="section4">

  <p>Under the discretion of bookmakers, all insights provided are for informational purposes only. 1X2S holds no responsibility for any betting decisions made based on the insights presented on this platform.</p>
  <p>Bookmaker odds and/or markets may vary and are subject to change without notice. Displayed odds are correct at the time of publication but may change subsequently.</p>

</section>  




  <div id="footer-container"></div>
  <script src="/assets/js/components/footer.js"></script>
  <link rel="stylesheet" href="/assets/css/components/footer.css">




</body>
</html>



